{
  "hash": "b44f22322ab648e0620465f88fef3098",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Quantifying uncertainty\nsubtitle: Suggested answers\ncategories:\n  - Application exercise\n  - Answers\neditor: visual\neditor_options:\n  chunk_output_type: console\nexecute:\n  warning: false\n  error: false\n---\n\nAn article in the The Tucson Citizen-Times published in the summer of 2020 claims that the average price per guest (ppg) for properties in Tucson is \\$95 on Airbnb.\nTo evaluate their claim we will use a dataset on 50 randomly selected Asheville Airbnb listings in July 2024.\nThese data can be found in `data/tucson.csv`.\n\nLet's load the packages we'll use first.\n\n::: {#load-packages .cell message='false' execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy import stats\n```\n:::\n\n\nAnd then the data.\n\n::: {#load-data .cell message='false' execution_count=2}\n``` {.python .cell-code}\ntucson = pd.read_csv(\"data/tucson.csv\")\n```\n:::\n\n\n# Hypotheses\n\n-   **Your turn:** Write out the correct null and alternative hypothesis. Do this in both words *and* in proper notation.\n\nNull Hypothesis $H_0$: The population mean is 95.\n\nAlternative Hypothesis $H_1$: The population mean is not 95.\nIn proper notation:\n\n$H_0=95$\n\n$H_1\\ne95$\n\n# Observed data\n\nOur goal is to use calculate the probability of a sample statistic at least as extreme as the one observed in our data if in fact the null hypothesis is true.\n\n-   **Demo:** Calculate and report the sample statistic below using proper notation.\n\n::: {#point-estimate .cell execution_count=3}\n``` {.python .cell-code}\nsample_mean = np.mean(tucson)\nprint(f\"Sample Mean (x̄) = {sample_mean}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSample Mean (x̄) = 116.24\n```\n:::\n:::\n\n\n$$\\bar{x} = 116.24$$\n\n# The null distribution\n\nLet's use simulation-based methods to conduct the hypothesis test specified above.\n\n## Generate\n\nWe'll start by generating the null distribution.\n\n-   **Demo:** Generate the null distribution?\n\n::: {#set-seed .cell execution_count=4}\n``` {.python .cell-code}\nnp.random.seed(4321)\n```\n:::\n\n\n::: {#null-dist-generate .cell execution_count=5}\n``` {.python .cell-code}\nnull_dist = np.random.normal(loc=95, scale=10, size=100)\n```\n:::\n\n\n-   **Your turn:** Take a look at `null_dist`. What does each element in this distribution represent?\n\n::: {#cell-null-dist-view .cell execution_count=6}\n``` {.python .cell-code}\nnull_dist\n```\n\n::: {#null-dist-view .cell-output .cell-output-display execution_count=6}\n```\narray([ 87.33478478, 104.61194695, 109.56346989,  89.7020731 ,\n        92.35232586,  89.27828692,  87.48886531, 117.28216569,\n       101.57340569,  83.67622437,  98.30181197,  96.31013196,\n       103.01451786,  80.37286965,  80.88610336,  78.468763  ,\n        93.56570295, 100.16490053, 107.80087422,  82.74861397,\n        87.2088676 ,  93.7092113 , 100.55408113,  99.18401772,\n        98.29309798, 106.40023999,  94.91981323, 102.69954647,\n        81.46955157,  88.47649639,  78.49663864, 104.86594118,\n       112.46368986,  92.02503253,  98.65064558,  80.27660804,\n       100.33236323,  78.75490245,  81.42329282,  87.32500706,\n        97.84587109,  81.5594462 ,  85.12719922,  84.48117254,\n        91.42923616,  82.15341658, 114.65849867,  96.63009839,\n        99.27606146,  96.73087054,  85.91204966, 100.34716493,\n       120.69636954, 108.0136492 , 104.51987563,  87.58164161,\n        82.68320485,  94.61699121, 106.36757592,  82.29514124,\n        86.72605901,  75.6560056 , 109.68802303,  98.50489351,\n        86.28368309, 106.07868825,  96.19387878,  92.17637865,\n        98.82258834, 108.78046332,  86.37912222,  84.16620754,\n       103.66433044,  67.71216648, 105.6099454 , 101.80642532,\n        98.00657111, 100.21304825, 111.73119724,  93.26666422,\n        97.71410213,  90.98243209, 104.16551224, 106.46138273,\n        77.86970271,  84.6999181 ,  93.97713389, 110.03244771,\n        95.88464514,  86.59610784,  93.37577223, 101.07466803,\n        89.42442386, 101.26545529,  96.38425149,  85.57312916,\n       107.23043531,  84.14081282,  72.83178286,  92.37777386])\n```\n:::\n:::\n\n\n## Visualize\n\n-   **Question:** Before you visualize the distribution of `null_dist` -- at what value would you expect this distribution to be centered? Why?\n\nAt 75, since we created this distribution assuming $\\mu=95$\n\n-   **Demo:** Create an appropriate visualization for your null distribution. Does the center of the distribution match what you guessed in the previous question?\n\n::: {#cell-null-dist-visualize .cell execution_count=7}\n``` {.python .cell-code}\nsns.histplot(null_dist, kde=True, palette=\"colorblind\")\nplt.xlabel('Sample Mean')\nplt.ylabel('Frequency')\nplt.title('Null Distribution with Sample Mean')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](ae-09-hypothesis-testing-A_files/figure-html/null-dist-visualize-output-1.png){#null-dist-visualize width=585 height=449}\n:::\n:::\n\n\n-   **Demo:** Now, add a vertical red line on your null distribution that represents your sample statistic.\n\n::: {#cell-null-dist-annotate .cell execution_count=8}\n``` {.python .cell-code}\nsns.histplot(null_dist, kde=True)\nplt.axvline(116.24, color='red', linestyle='solid', linewidth=2)\nplt.xlabel('Sample Mean')\nplt.ylabel('Frequency')\nplt.title('Null Distribution with Sample Mean')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](ae-09-hypothesis-testing-A_files/figure-html/null-dist-annotate-output-1.png){#null-dist-annotate width=585 height=449}\n:::\n:::\n\n\n-   **Question:** Based on the position of this line, does your observed sample mean appear to be an unusual observation under the assumption of the null hypothesis?\n\nYes, it’s pretty far from the center.\n\n# p-value\n\nAbove, we eyeballed how likely/unlikely our observed mean is.\nNow, let's actually quantify it using a p-value.\n\n-   **Question:** What is a p-value?\n\nThe probability of the observed sample statistic, or something more extreme in the direction of the alternative hypothesis, if in fact the null hypothesis is true.\n\n-   **Demo:** Visualize the p-value.\n\n::: {#cell-p-value-visualize .cell execution_count=9}\n``` {.python .cell-code}\np_value = (null_dist >= sample_mean).mean()\nprint(f\"P-value = {p_value}\")\n\n# Visualize the p-value\nsns.histplot(null_dist, kde=True)\nplt.axvline(116.24, color='red', linestyle='solid', linewidth=2)\nplt.axvline(73.77, color='red', linestyle='dashed', linewidth=2)\nplt.xlabel('Sample Mean')\nplt.ylabel('Frequency')\nplt.title('Null Distribution with P-value')\nplt.show()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nP-value = 0.02\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](ae-09-hypothesis-testing-A_files/figure-html/p-value-visualize-output-2.png){#p-value-visualize width=585 height=449}\n:::\n:::\n\n\n-   **Your turn:** What is the p-value?\n\n$\\text{P-value}=0.02$\n\n# Conclusion\n\n-   **Your turn:** What is the conclusion of the hypothesis test based on the p-value you calculated? Make sure to frame it in context of the data and the research question. Use a significance level of 5% to make your conclusion.\n\nSince the p-value is smaller than the significance level, we reject the null hypothesis.\nThe data provide convincing evidence that the average price per guest of properties on Airbnb in Tucson is different than \\$95.\n\n-   **Demo:** Interpret the p-value in context of the data and the research question.\n\nIf in fact the true average price per guest of properties on Airbnb in Tucson is \\$95, the probability of observing a random sample of 50 Tucson Airbnb listings where the average price per guest is \\$116.23 or higher or \\$73.77 or lower is 0.02.\n\n# Get real...\n\n-   **Question:** What we did above was a \"toy example\" to illustrate hypothesis test. What would you change to make this a real, more robust analysis?\n\nChange the number of resamples to a higher number, somewhere \\~10,000 replicates.\n\n-   **Demo:** Work through the analysis again with these changes.\n\n::: {#hypothesis-test .cell execution_count=10}\n``` {.python .cell-code}\nnull_dist_large = np.random.normal(loc=95, scale=10, size=10000)\n\nnull_dist_large = np.array(null_dist_large)\n\npoint_estimate = tucson['ppg'].mean()\nprint(f\"Point Estimate (Sample Mean) = {point_estimate}\")\n\np_value = (null_dist_large >= point_estimate).mean() if point_estimate > 95 else (null_dist <= point_estimate).mean()\np_value_two_sided = 2 * min((null_dist_large >= point_estimate).mean(), (null_dist_large <= point_estimate).mean())\nprint(f\"Two-sided P-value = {p_value_two_sided}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPoint Estimate (Sample Mean) = 116.24\nTwo-sided P-value = 0.04\n```\n:::\n:::\n\n\n::: {#fd475fa7 .cell execution_count=11}\n``` {.python .cell-code}\nsample_mean_large = null_dist_large.mean()\n\n# Visualize the new p-value\nsns.histplot(null_dist_large, kde=True)\nplt.axvline(sample_mean_large, color='red', linestyle='dashed', linewidth=2)\nplt.fill_betweenx(y=[0, max(sns.histplot(null_dist_large, kde=True).get_lines()[0].get_ydata())],\n                  x1=sample_mean_large, x2=max(null_dist_large), color='red', alpha=0.3)\nplt.xlabel('Sample Mean')\nplt.ylabel('Frequency')\nplt.title('Null Distribution with P-value (Larger Sample)')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](ae-09-hypothesis-testing-A_files/figure-html/cell-12-output-1.png){width=593 height=449}\n:::\n:::\n\n\n",
    "supporting": [
      "ae-09-hypothesis-testing-A_files/figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}